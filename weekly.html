<!DOCTYPE html>
<html lang = "zh-TW">

    <!-- ä¸æœƒé¡¯ç¤ºæ–¼ç¶²é ç€è¦½è€…çœ¼å‰çš„ -->
  <head>
    <meta charset = "utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åˆé¤é»é¤ç³»çµ± - æœ¬é€±èœå–®</title>
    <link rel="stylesheet" href="style.css">
  </head>

  <!-- æ‰€æœ‰æœƒé¡¯ç¤ºæ–¼ç¶²é ç€è¦½è€…çœ¼å‰çš„å…§å®¹ -->
  <body>

    <!-- Header -->
    <div class = "header">
      <h1>ğŸ± åˆé¤é»é¤ç³»çµ±</h1>
      <p>ä½ çš„åˆé¤æ•‘æ˜Ÿ ğŸŒŸ</p>
    </div>

    <!-- Navigation Bar -->
    <div class = "navbar">
      <a href="index.html">ğŸ—³ï¸ æŠ•ç¥¨ä¸­</a>
      <a href="weekly.html" class="active">ğŸ“… æœ¬é€±åƒä»€éº¼</a>
      <a href="restaurants.html">ğŸª ä¾¿ç•¶åº—å®¶</a>
      <a href="add_restaurants.html"> â• æ–°å¢åº—å®¶</a>
    </div>

    <!-- Main Content -->
    <div class = "main">
      <section class = "weekly-menu">
        <h2>ğŸ“… æœ¬é€±åˆé¤èœå–®</h2>
        
        <div id="loading" class="loading">
          è¼‰å…¥æœ¬é€±èœå–®ä¸­...
        </div>

        <div class="week-container" id="weekContainer" style="display: none;">
          <div class="day-menu">
            <div class="day-header">
              <h3>ğŸ—“ï¸ æ˜ŸæœŸä¸€</h3>
              <span class="date-badge" id="mondayDate"></span>
            </div>
            <p class="selected-lunch no-selection" id="mondayLunch">å°šæœªé¸æ“‡</p>
            <p class="vote-info" id="mondayVotes"></p>
          </div>
          
          <div class="day-menu">
            <div class="day-header">
              <h3>ğŸ—“ï¸ æ˜ŸæœŸäºŒ</h3>
              <span class="date-badge" id="tuesdayDate"></span>
            </div>
            <p class="selected-lunch no-selection" id="tuesdayLunch">å°šæœªé¸æ“‡</p>
            <p class="vote-info" id="tuesdayVotes"></p>
          </div>
          
          <div class="day-menu">
            <div class="day-header">
              <h3>ğŸ—“ï¸ æ˜ŸæœŸä¸‰</h3>
              <span class="date-badge" id="wednesdayDate"></span>
            </div>
            <p class="selected-lunch no-selection" id="wednesdayLunch">å°šæœªé¸æ“‡</p>
            <p class="vote-info" id="wednesdayVotes"></p>
          </div>
          
          <div class="day-menu">
            <div class="day-header">
              <h3>ğŸ—“ï¸ æ˜ŸæœŸå››</h3>
              <span class="date-badge" id="thursdayDate"></span>
            </div>
            <p class="selected-lunch no-selection" id="thursdayLunch">å°šæœªé¸æ“‡</p>
            <p class="vote-info" id="thursdayVotes"></p>
          </div>
          
          <div class="day-menu">
            <div class="day-header">
              <h3>ğŸ—“ï¸ æ˜ŸæœŸäº”</h3>
              <span class="date-badge" id="fridayDate"></span>
            </div>
            <p class="selected-lunch no-selection" id="fridayLunch">å°šæœªé¸æ“‡</p>
            <p class="vote-info" id="fridayVotes"></p>
          </div>
        </div>
      </section>
    </div>

    <!-- Footer -->
    <div class = "footer">
      <p>ç‰ˆæ¬Šæ‰€æœ‰ &copy; 2026 åˆé¤é»é¤ç³»çµ±</p>
    </div>

    <!-- å¼•å…¥å¤–éƒ¨ JavaScript æª”æ¡ˆ -->
    <!--<script src="script.js"></script>-->

    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
      import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-database.js";

      const firebaseConfig = {
          apiKey: "AIzaSyAdo-mbq_BQ5tqY4nvscVNtah24Mb8ohmU",
          authDomain: "realtimevote-f8b6d.firebaseapp.com",
          databaseURL: "https://realtimevote-f8b6d-default-rtdb.firebaseio.com/",
          projectId: "realtimevote-f8b6d",
          storageBucket: "realtimevote-f8b6d.firebasestorage.app",
          messagingSenderId: "44615577610",
          appId: "1:44615577610:web:1bf827f2899ae2550d6ff3",
          measurementId: "G-MW1RJZSC0E"
      };

      const app = initializeApp(firebaseConfig);
      const database = getDatabase(app);
      const weeklyRef = ref(database, 'weekly');

      // å–å¾—æœ¬é€±çš„æ—¥æœŸ
      function getWeekDates() {
        const now = new Date();
        const dayOfWeek = now.getDay(); // 0=é€±æ—¥, 1=é€±ä¸€, ..., 6=é€±å…­
        
        // è¨ˆç®—æœ¬é€±ä¸€çš„æ—¥æœŸ
        const monday = new Date(now);
        const diff = dayOfWeek === 0 ? -6 : 1 - dayOfWeek; // å¦‚æœæ˜¯é€±æ—¥,å¾€å‰æ¨6å¤©
        monday.setDate(now.getDate() + diff);
        
        const dates = {};
        const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday'];
        
        days.forEach((day, index) => {
          const date = new Date(monday);
          date.setDate(monday.getDate() + index);
          dates[day] = date.toLocaleDateString('zh-TW', { month: '2-digit', day: '2-digit' });
        });
        
        return dates;
      }

      // é¡¯ç¤ºæ—¥æœŸ
      const weekDates = getWeekDates();
      document.getElementById('mondayDate').textContent = weekDates.monday;
      document.getElementById('tuesdayDate').textContent = weekDates.tuesday;
      document.getElementById('wednesdayDate').textContent = weekDates.wednesday;
      document.getElementById('thursdayDate').textContent = weekDates.thursday;
      document.getElementById('fridayDate').textContent = weekDates.friday;

      // ç›£è½æ¯é€±èœå–®è³‡æ–™
      onValue(weeklyRef, (snapshot) => {
        const weeklyData = snapshot.val();
        
        // éš±è—è¼‰å…¥è¨Šæ¯ï¼Œé¡¯ç¤ºèœå–®å®¹å™¨
        document.getElementById('loading').style.display = 'none';
        document.getElementById('weekContainer').style.display = 'block';

        const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday'];
        const dayNames = {
          'monday': 'æ˜ŸæœŸä¸€',
          'tuesday': 'æ˜ŸæœŸäºŒ',
          'wednesday': 'æ˜ŸæœŸä¸‰',
          'thursday': 'æ˜ŸæœŸå››',
          'friday': 'æ˜ŸæœŸäº”'
        };

        days.forEach(day => {
          const lunchElement = document.getElementById(`${day}Lunch`);
          const votesElement = document.getElementById(`${day}Votes`);
          
          if (weeklyData && weeklyData[day]) {
            const data = weeklyData[day];
            lunchElement.textContent = `ğŸ± ${data.restaurantName}`;
            lunchElement.classList.remove('no-selection');
            votesElement.textContent = `å¾—ç¥¨æ•¸ï¼š${data.votes} ç¥¨ | æŠ•ç¥¨æ—¥æœŸï¼š${data.date}`;
          } else {
            lunchElement.textContent = 'å°šæœªé¸æ“‡';
            lunchElement.classList.add('no-selection');
            votesElement.textContent = '';
          }
        });
      });

      // é«˜äº®é¡¯ç¤ºä»Šå¤©
      function highlightToday() {
        const now = new Date();
        const dayOfWeek = now.getDay();
        
        const dayMap = {
          1: 'monday',
          2: 'tuesday',
          3: 'wednesday',
          4: 'thursday',
          5: 'friday'
        };
        
        const todayKey = dayMap[dayOfWeek];
        
        if (todayKey) {
          const todayElement = document.getElementById(`${todayKey}Lunch`).parentElement;
          todayElement.style.border = '3px solid #4CAF50';
          todayElement.style.background = '#f1f8e9';
        }
      }

      highlightToday();
    </script>
    
  </body>

</html>